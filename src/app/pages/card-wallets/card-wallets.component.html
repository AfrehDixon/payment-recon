<div class="card-wallets-container">
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <h1>Customer Wallets</h1>
      <div class="search-section">
        <div class="search-box">
          <svg
            class="search-icon"
            viewBox="0 0 24 24"
            width="18"
            height="18"
            stroke="currentColor"
            fill="none"
          >
            <circle cx="11" cy="11" r="8" />
            <line x1="21" y1="21" x2="16.65" y2="16.65" />
          </svg>
          <input
            type="text"
            placeholder="Search wallets by account number, name, issuer..."
            (keyup)="searchWallets($event)"
            class="search-input"
          />
        </div>
        <div class="wallets-count" *ngIf="!loading">
          {{ totalItems }} wallet{{ totalItems !== 1 ? "s" : "" }}
        </div>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="error-message">
    {{ error }}
    <button class="close-btn" (click)="error = null">&times;</button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-spinner">
    <div class="spinner"></div>
    <span>Loading wallets...</span>
  </div>

  <!-- Wallets Table -->
  <div class="table-container" *ngIf="!loading && wallets.length > 0">
    <table class="wallets-table">
      <thead>
        <tr>
          <th>Token ID</th>
          <th>Account Name</th>
          <th>Account Number</th>
          <th>Issuer</th>
          <th>Type</th>
          <th>Created</th>
          <th>Last Updated</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let wallet of paginatedWallets" class="wallet-row">
          <td class="token-cell">
            <span class="token-id">{{ wallet.tokenId | slice:0:8 }}...</span>
          </td>
          <td>
            <span class="account-name">{{ wallet.account_name }}</span>
          </td>
          <td>
            <span class="account-number">•••• {{ wallet.account_number }}</span>
          </td>
          <td>
            <span class="issuer">{{ wallet.account_issuer | uppercase }}</span>
          </td>
          <td>
            <span class="status-badge status-active">{{ wallet.account_type }}</span>
          </td>
          <td>{{ formatDate(wallet.createdAt) }}</td>
          <td>{{ formatDate(wallet.updatedAt) }}</td>
          <td>
            <button class="delete-btn" (click)="openDeleteConfirmation(wallet)">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M3 6h18m-2 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
              </svg>
              Delete
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Pagination Controls -->
    <div class="pagination-container" *ngIf="totalPages > 1">
      <div class="pagination-info">
        Showing {{ startIndex + 1 }} to {{ endIndex }} of {{ totalItems }} entries
      </div>
      
      <div class="pagination-controls">
        <button 
          class="pagination-btn" 
          [disabled]="currentPage === 1"
          (click)="goToPage(1)">
          First
        </button>
        
        <button 
          class="pagination-btn" 
          [disabled]="currentPage === 1"
          (click)="previousPage()">
          Previous
        </button>
        
        <span class="page-numbers">
          <button 
            *ngFor="let page of getVisiblePages()" 
            class="page-btn"
            [class.active]="page === currentPage"
            (click)="goToPage(page)">
            {{ page }}
          </button>
        </span>
        
        <button 
          class="pagination-btn" 
          [disabled]="currentPage === totalPages"
          (click)="nextPage()">
          Next
        </button>
        
        <button 
          class="pagination-btn" 
          [disabled]="currentPage === totalPages"
          (click)="goToPage(totalPages)">
          Last
        </button>
      </div>

      <div class="items-per-page">
        <label>Items per page:</label>
        <select (change)="changeItemsPerPage($event)" [value]="itemsPerPage">
          <option value="10">10</option>
          <option value="25">25</option>
          <option value="50">50</option>
          <option value="100">100</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && wallets.length === 0" class="empty-state">
    <i class="fas fa-credit-card"></i>
    <p>No card wallets found.</p>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal" *ngIf="showDeleteConfirmation">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Delete Card Wallet</h2>
        <button class="close-btn" (click)="closeDeleteConfirmation()">
          &times;
        </button>
      </div>

      <div *ngIf="selectedWallet" class="wallet-info">
        <p>Are you sure you want to delete this card wallet?</p>
        <div class="info-row">
          <span class="label">Card Name:</span>
          <span class="value">{{ selectedWallet.account_name }}</span>
        </div>
        <div class="info-row">
          <span class="label">Card Number:</span>
          <span class="value">•••• {{ selectedWallet.account_number }}</span>
        </div>
        <div class="info-row">
          <span class="label">Issuer:</span>
          <span class="value">{{ selectedWallet.account_issuer }}</span>
        </div>
      </div>

      <div class="modal-actions">
        <button
          type="button"
          class="cancel-btn"
          (click)="closeDeleteConfirmation()"
        >
          Cancel
        </button>
        <button
          type="button"
          class="delete-confirm-btn"
          (click)="deleteWallet()"
          [disabled]="loading"
        >
          {{ loading ? 'Deleting...' : 'Delete Wallet' }}
        </button>
      </div>
    </div>
  </div>
</div>